---
fr:
  api_entreprise:
    documentation_pages:
      developers:
        title: Espace dÃ©veloppeurs&nbsp;ğŸ› 
        sections:
          - anchor: 'prerequis-techniques'
            title: PrÃ©requis techniques
            content: |+
              Voici la liste des **fondamentaux techniques Ã  mettre en place pour le bon fonctionnement de lâ€™API&nbsp;Entreprise**&nbsp;:

              - â˜‘ï¸ ÃŠtre en mesure de gÃ©rer le protocole HTTPS ;
              - â˜‘ï¸ Avoir une version de langage rÃ©cente. Si vous utilisez Java, une version >= 1.8 est nÃ©cessaire (pour la gestion des certificats de +1024 bit, du TLS 1.2 minimum et des suites cryptographiques - ciphers) ;
              - â˜‘ï¸ Sâ€™assurer que nos AutoritÃ©s de Certification (AC) pour les certificats SSL sont autorisÃ©es par vos systÃ¨mes ;
              - â˜‘ï¸ L'API&nbsp;Entreprise est uniquement accessible par internet. Si vous avez un pare-feu, il faut donc prÃ©voir de whitelister l'adresse IP du service API Entreprise ;
              - â˜‘ï¸ Il est interdit d'interroger l'API&nbsp;Entreprise depuis un site web en front-end, car le jeton d'accÃ¨s serait alors divulguÃ©. Il vous faut donc interroger nos API depuis une application en back-end. Nous n'autoriserons pas le CORS (CORS - Cross Origin Ressource Sharing) ;
              - â˜‘ï¸ PrÃ©voir non seulement les coÃ»ts de dÃ©veloppement mais Ã©galement les coÃ»ts de maintenance ;
              - â˜‘ï¸ ÃŠtre en capacitÃ© de gÃ©rer les mises Ã  jour de l'API&nbsp;Entreprise.

              <br>
              ğŸ’¡ Pour mieux comprendre l'API&nbsp;Entreprise avant de demander un accÃ¨s, **vous pouvez utiliser [notre environnement de test](<%= developers_path(anchor: 'tester-api-preproduction') %>)**.

          - anchor: 'specifications-generales'
            title: SpÃ©cifications gÃ©nÃ©rales&nbsp;ğŸ›
            subsections:
              - title: Respecter la volumÃ©trie
                anchor: 'respecter-la-volumÃ©trie'
                content: |+
                  #### Les plafonds

                  Les limites de volumÃ©trie sur API&nbsp;Entreprise se dÃ©composent en deux rÃ¨gles principales&nbsp;:&nbsp;

                  - **Un plafond gÃ©nÃ©ral par IP de 1000 requÃªtes/minute**.

                  - **Une volumÃ©trie par jeton par groupe dâ€™endpoints&nbsp;:**
                        - **1er groupe**&nbsp;:&nbsp;Les endpoints renvoyant du JSON constituent un premier groupe. Vous pouvez effectuer jusquâ€™Ã  250 requÃªtes/min/jeton sur ce groupe.
                        - **2Ã¨me groupe**&nbsp;:&nbsp;Les endpoints transmettant des documents constituent un autre groupe. La volumÃ©trie maximale dâ€™appel concernant ce groupe est de 50 requÃªtes/min/jeton.
                        - **Exceptions**&nbsp;:&nbsp;Certains endpoints Ã©chappent Ã  cette rÃ¨gle et prÃ©sentent une volumÃ©trie spÃ©cifique par endpoint. Il s'agit notamment de lâ€™[API attestation fiscale de la DGFIP](<%= developers_openapi_path(anchor: 'tag/Attestations-sociales-et-fiscales/paths/~1v4~1dgfip~1unites_legales~1{siren}~1attestation_fiscale/get') %>){:target="_blank"}, de l'[API dÃ©prÃ©ciÃ©e Actes de lâ€™INPI](<%= developers_openapi_path(anchor: 'tag/Informations-generales/paths/~1v3~1inpi~1unites_legales~1{siren}~1actes/get') %>){:target="_blank"}{:target="_blank"} ou encore des [API effectifs du GIP-MDS](<%= developers_openapi_path(anchor: 'tag/Informations-generales/paths/~1v3~1gip_mds~1unites_legales~1{siren}~1effectifs_annuels~1{year}/get') %>){:target="_blank"}. Comme pour toutes les API du bouquet, la volumÃ©trie exacte figure dans le header.

                  #### Informations volumÃ©trie dans le header

                  ##### Pour toutes les rÃ©ponses&nbsp;:

                  Dans toutes les rÃ©ponses de nos API, le header vous transmet des informations sur la volumÃ©trie&nbsp;:

                  {:.fr-table}
                  | Champs du header    |   Signification    |     Format           |
                  |:------------------------------|:------------------|:------------:|
                  | `RateLimit-Limit` |La **limite** concernant l'endpoint appelÃ©, soit le nombre de requÃªte/minute. | Nombre|
                  | `RateLimit-Remaining` |Le **nombre d'appels restants** durant la pÃ©riode courante d'une minute. | Nombre |
                  | `RateLimit-Reset` |La **fin de la pÃ©riode** courante. | Timestamp |

                  {:.fr-highlight.fr-highlight--example}
                  >**Exemple&nbsp;:**
                  >ConsidÃ©rons un endpoint ayant une limite de 50 appels /minute.
                  >Vous faÃ®tes un premier appel Ã  10h00 pile, et effectuez un second appel 20 secondes plus tard, puis un troisiÃ¨me 10 secondes plus tard, vous aurez les valeurs suivantes :
                  > - `RateLimit-Limit` : 50 ;
                  > - `RateLimit-Remaining` : 47 (50 moins les 3 appels effectuÃ©s) ;
                  > - `RateLimit-Reset` : [*Timestamp correspondant au jour prÃ©sent Ã  10h01*]. Le premier appel initialise le compteur (Ã  10h00 pile), la pÃ©riode se termine 1min plus tard.
                  >
                  > Vous pouvez donc jusqu'Ã  10h01 pile effectuer 47 appels, le compteur sera rÃ©initialisÃ© Ã  50 Ã  ce moment-lÃ .

                  ##### En cas de dÃ©passement :

                  Si vous dÃ©passez le nombre d'appels autorisÃ©s (`RateLimit-Remaining = 0`), le serveur rÃ©pondra avec le `status 429` sur tous les appels suivants dans la mÃªme pÃ©riode.

                  Le header associÃ© Ã  ce code erreur `429` sera accompagnÃ©&nbsp;:&nbsp;
                  - des trois champs prÃ©cÃ©dents ;
                  - d'un champ supplÃ©mentaire indiquant le temps Ã  attendre avant de pouvoir effectuer des nouveaux appels.

                  {:.fr-table}
                  | Champs du header    |   Signification    |     Format           |
                  |:------------------------------|:------------------|:------------:|
                  | `RateLimit-Limit` |La **limite** concernant l'endpoint appelÃ©, soit le nombre de requÃªte/minute. | Nombre|
                  | `RateLimit-Remaining` |Le **nombre d'appels restants** durant la pÃ©riode courante d'une minute. | Nombre |
                  | `RateLimit-Reset` |La **fin de la pÃ©riode** courante. | Timestamp |
                  | *Uniquement pour le header associÃ© au code erreur 429* <br> `Retry-after`| **DÃ©compte du nombre de secondes restantes** avant la prochaine pÃ©riode | Secondes |

                  Vous pouvez donc **utiliser les champs du header pour optimiser votre consommation de l'API&nbsp;Entreprise**.

                  #### RÃ¨gles de bannissement en cas de surconsommation

                  En cas de non prise en compte des codes erreurs `429` ou en cas de dÃ©passement de la limite de volumÃ©trie globale, **votre IP sera temporairement bannie de nos serveurs pour une durÃ©e fixe et non rÃ©vocable de 12h**. Si vous avez plusieurs jetons, tous seront donc bloquÃ©s pendant ce laps de temps.

                  Les appels depuis une IP bannie ne renvoient pas de codes HTTP, le serveur ne rÃ©pond tout simplement pas.
                  Vous pouvez en revanche vÃ©rifier si vous avez dÃ©passÃ© ce seuil depuis votre [compte utilisateur](<%= authorization_requests_path %>){:target="_blank"}.

                  {:.fr-highlight}
                  > â„¹ï¸ Au bout de ces 12 heures, vos accÃ¨s sont automatiquement rÃ©tablis ; **il est donc inutile d'Ã©crire au support**.

                  Nous vous invitons Ã  prendre les mesures nÃ©cessaires car le dÃ©passement intervient gÃ©nÃ©ralement chez nos utilisateurs lorsque leur programme n'a pas Ã©tÃ© correctement configurÃ©.

                  Pour les appels de traitement de masse, il est souhaitable que vous fassiez vos **batchs automatiques la nuit ou durant les heures creuses** afin de ne pas affecter la qualitÃ© du service pour le reste des usagers.

              - title: Configurer vos timeout
                anchor: 'configurer-vos-timeout'
                content: |+
                  Le timeout est le temps d'attente maximal de rÃ©ponse Ã  une requÃªte. Il vous permet de ne pas immobiliser votre logiciel en le laissant bloquÃ© sur un appel sans rÃ©ponse.

                  De faÃ§on gÃ©nÃ©rale, nous vous recommandons un timeout&nbsp;:&nbsp;
                  - de **5 secondes** pour les appels de donnÃ©es structurÃ©es JSON ;
                  - de **12 secondes** pour les appels retournant un PDF ou un ZIP.

                  De mÃªme, pour ne pas immobiliser nos serveurs, nous attendons les rÃ©ponses de nos fournisseurs un maximum de 10 secondes avant de vous les retransmettre. Si ce dÃ©lai dâ€™attente est dÃ©passÃ© un code erreur HTTP `504` vous sera renvoyÃ©.

              - title: Autoriser nos AutoritÃ©s de Certifications
                anchor: 'autoriser-nos-autoritÃ©s-de-certifications'
                content: |+
                  API&nbsp;Entreprise utilise [DHIMYOTIS](https://www.dhimyotis.com/) comme organisme de dÃ©livrance de ses certificats SSL principaux ainsi que [Let's Encrypt](https://letsencrypt.org/) pour certains services secondaires.

                  Il est conseillÃ© d'ajouter ces AutoritÃ©s de Certifications (AC) Ã  votre base de confiance si vous en avez une. Une solution idÃ©ale est d'utiliser un paquet d'autoritÃ©s mises Ã  jour automatiquement ([Mozilla par exemple](https://wiki.mozilla.org/CA/Included_Certificates))

                  API&nbsp;Entreprise utilise des certificats multi-domaines ; c'est-Ã -dire avec un "nom courant" (_common name - CN_) et plusieurs "noms alternatifs du sujet" (_subject alternatives names - SAN_), **soyez certains que vos outils fonctionnent correctement avec**.

              - title: GÃ©rer les erreurs - codes HTTPS
                anchor: 'gÃ©rer-les-erreurs---codes-https'
                content: |+
                  #### Un code standard HTTPS pour catÃ©goriser le statut de l'appel
                  Toutes les rÃ©ponse de lâ€™API&nbsp;Entreprise sont envoyÃ©es avec un code HTTPS. **Ces codes permettent de se renseigner sur le statut de lâ€™appel**, et sont harmonisÃ©s pour l'ensemble des API quelque soir le fournisseur de donnÃ©es.
                  Pour en savoir plus sur les codes HTTPS, cet article de [Wikipedia](https://fr.wikipedia.org/wiki/Liste_des_codes_HTTP){:target="_blank"} constitue une bonne base explicative.

                  ##### En cas de succÃ¨s, le code HTTP commence par 2 :

                  {:.fr-table}
                  | Code HTTPS                                       |      Signification                 |
                  |--------------------------------------------------|------------------------------------|
                  |`200` | **Tout va bien.**|

                  ##### En cas dâ€™Ã©chec, si lâ€™erreur vient de votre cÃ´tÃ©, le code HTTP commence par 4 :

                  {:.fr-table}
                  | Code HTTP                       |      Signification                     |
                  |---------------------------------|----------------------------------------|
                  |`400` | **Mauvaise requÃªte** â€“ La syntaxe de votre requÃªte est erronÃ©e.|
                  |`401` | **Non autorisÃ©** â€“ Votre token est invalide ou manquant.|
                  |`403` | **Interdit** â€“ Le serveur a compris votre requÃªte mais refuse de lâ€™exÃ©cuter car votre jeton ne vous donne pas accÃ¨s Ã  cette ressource.|
                  |`404` | **Non trouvÃ©** â€“ La ressource (l'entreprise, le certificat, â€¦) demandÃ©e n'a pas Ã©tÃ© trouvÃ©e. Cette erreur intervient par exemple lors de lâ€™entrÃ©e dâ€™un numÃ©ro de SIREN qui nâ€™existe pas, ou bien lorsque lâ€™entreprise quâ€™il designe est en dehors du pÃ©rimÃ¨tre de lâ€™endpoint.|
                  |`422` | **EntitÃ© non traitable** â€“ Le format de la donnÃ©e passÃ©e en paramÃ¨tre n'est pas acceptÃ©. Par exemple, si vous entrez 20 chiffres dans le paramÃ¨tre SIREN, votre requÃªte est automatiquement rejetÃ©e, car un SIREN fait obligatoirement 9 chiffres.|
                  |`451` | **Indisponible pour raisons lÃ©gales** - ce code est spÃ©cifiquement renvoyÃ© lorsque vous demandez les informations dâ€™une entreprise ou dâ€™un Ã©tablissement non diffusible au travers des endpoints `entreprises` et `etablissements` de lâ€™INSEE, sans avoir utilisÃ© lâ€™option dâ€™appel spÃ©cifique. Pour en savoir plus, [consultez la documentation de cet endpoint dans le catalogue de donnÃ©es](../catalogue/).|


                  ###### En cas dâ€™Ã©chec, si lâ€™erreur provient dâ€™API&nbsp;Entreprise ou bien des fournisseurs de donnÃ©es, le code HTTP commence par 5 :

                  {:.fr-table}
                  | Code HTTP                        |      Signification                     |
                  |----------------------------------|----------------------------------------|
                  |`500` | **Erreur interne Ã  API&nbsp;Entreprise** â€“ Une erreur interne du serveur dâ€™API&nbsp;Entreprise est survenue. [Consultez votre compte utilisateur](<%= authorization_requests_path %>){:target="_blank"}, lâ€™historique de lâ€™incident devrait y Ãªtre affichÃ© ; ainsi que les actions Ã  venir.
                  |`502` | **Erreur interne fournisseur** â€“ Une erreur interne du serveur du ou des fournisseurs est survenue. [Consultez votre compte utilisateur](<%= authorization_requests_path %>){:target="_blank"}, lâ€™historique de lâ€™incident devrait y Ãªtre affichÃ© ; ainsi que les actions Ã  venir.
                  |`503` | **Service non disponible** â€“ Le service est temporairement indisponible ou en maintenance. Pour connaÃ®tre lâ€™historique de disponibilitÃ© et les incidents type de lâ€™endpoint, vous pouvez [consulter le catalogue de donnÃ©es](../catalogue/).
                  |`504` | **IntermÃ©diaire hors dÃ©lai** â€“ Le(s) producteur(s) de donnÃ©es ont mis trop de temps Ã  rÃ©pondre. Notre temps dâ€™attente, nous permettant de ne pas immobiliser le serveur sur un appel sans rÃ©ponse, est fixÃ© Ã  10 secondes et a Ã©tÃ© dÃ©passÃ©.|


                  #### Un code supplÃ©mentaire pour prÃ©ciser l'erreur et enclencher une action

                  Tous les codes erreur HTTPS sont accompagnÃ©s de **codes plus prÃ©cis, spÃ©cifiques Ã  chaque situation dâ€™erreur**. Une explication en toutes lettres est Ã©galement donnÃ©e dans la payload. Enfin, dans certains cas, une mÃ©tadonnÃ©e actionnable est disponible.

                  Dans lâ€™exemple ci-dessous, la clÃ© `retry_in` permet justement de relancer un appel aprÃ¨s le nombre de secondes indiquÃ©es.

                  >_Exemple de payload d'un code HTTPS 502 :_
                  >```
                  >{
                  >    "errors": [
                  >       {
                  >            "code": "04501",
                  >            "title": "Analyse de la situation du compte en cours",
                  >            "detail": "La situation de l'entreprise requiert une analyse manuelle d'un agent de l'URSSAF. Une >demande d'analyse vient d'Ãªtre envoyÃ©e, cela prend au maximum 2 jours.",
                  >            "meta": {
                  >                "provider": "ACOSS",
                  >                "retry_in": 172800
                  >           }
                  >        }
                  >    ]
                  >}
                  >```


                  Retrouvez tous les codes erreurs pour chaque endpoint dans [notre swagger, partie "Response samples"](<%= developers_openapi_path %>){:target="_blank"}.
                  La liste des codes spÃ©cifiques Ã  chaque endpoint y est disponible.


              - title: Renseigner les paramÃ¨tres d'appel et de traÃ§abilitÃ©
                anchor: 'renseigner-les-paramÃ¨tres-dappel-et-de-traÃ§abilitÃ©'
                content: |+
                  API&nbsp;Entreprise vous permet dâ€™accÃ©der Ã  des donnÃ©es protÃ©gÃ©es. Câ€™est pourquoi, dans un **objectif de traÃ§abilitÃ©**, nous vous demandons de renseigner dans chacune de vos requÃªtes, non seulement un jeton dâ€™accÃ¨s, mais aussi **certaines informations qualifiant votre requÃªte**.


                  {:.fr-highlight.fr-highlight--caution}
                  > âš ï¸ **Ces paramÃ¨tres sont obligatoires**. Les appels ne comportant pas ces paramÃ¨tres sont rejetÃ©s, et un code erreur vous est renvoyÃ©.


                  Pour chaque endpoint, nous prÃ©cisons dans le [swagger, rubrique "Query parameters"](<%= developers_openapi_path %>){:target="_blank"} les paramÃ¨tres obligatoires spÃ©cifiques, ci-dessous une explication dÃ©taillÃ©e des Ã©lÃ©ments Ã  fournir pour chaque paramÃ¨tre de traÃ§abilitÃ© :

                  {:.fr-table}
                  | ParamÃ¨tre                                                  |      Information Ã  renseigner           |
                  |:----------------------------------------------------------:|-----------------------------------------|
                  |`&context=CadreDeLaRequÃªte`|**Le cadre de la requÃªte** <br><br>Par exemple : aides publiques, marchÃ©s publics ou gestion d'un rÃ©fÃ©rentiel tiers utilisÃ© pour tel type d'application*.*
                  |`&recipient=BÃ©nÃ©ficaireDeL'Appel`|**Le bÃ©nÃ©ficiaire de l'appel** <br><br>Ce paramÃ¨tre permet la traÃ§abilitÃ© de l'appel et doit correspondre au _SIRET de l'organisation publique habilitÃ©e Ã  utiliser la donnÃ©e_. <br><br>Si vous Ãªtes une collectivitÃ© ou une administration, ce paramÃ¨tre doit donc Ãªtre votre numÃ©ro de SIRET. Si vous Ãªtes un Ã©diteur, il s'agit du SIRET de l'organisation publique cliente demandant la donnÃ©e.<br><br>Une vÃ©rification est effectuÃ©e par API Entreprise pour refuser tout format qui ne serait pas un numÃ©ro de SIRET et pour refuser un SIRET qui serait identique Ã  l'entitÃ© appelÃ©e.
                  |`&object= RaisonDeL'AppelOuIdentifiant`|**La raison de l'appel** <br> ou l'identifiant de la procÃ©dure. <br><br> L'identifiant peut Ãªtre interne Ã  votre organisation ou bien un numÃ©ro de marchÃ© publique, un nom de procÃ©dure ; l'essentiel est que celui-ci vous permette de tracer et de retrouver les informations relatives Ã  l'appel. En effet, vous devez pouvoir justifier de la raison d'un appel auprÃ¨s du fournisseur de donnÃ©es. <br> Description courte (< 50 caractÃ¨res).

              - title: GÃ©rer les Ã©volutions de version
                anchor: 'gerer-les-evolutions-de-version'
                content: |+
                  Il est frÃ©quent que les API Ã©voluent et que, par consÃ©quent, de nouvelles versions soient publiÃ©es.
                  La version majeure V.3 de l'API&nbsp;Entreprise permet de crÃ©er facilement de nouvelles versions, tout en gardant les prÃ©cÃ©dentes, rendant ainsi accessibles rapidement les Ã©volutions qu'API Entreprise obtient de ses fournisseurs.

                  {:.fr-h5}
                  #### Toute Ã©volution implique une montÃ©e de version

                  Les montÃ©s de version d'une API interviennent pour toute Ã©volution, c'est-Ã -dire :
                  - l'ajout d'un nouveau champ par le fournisseur de la donnÃ©e ;

                    {:.fr-highlight.fr-highlight--example}
                    > Par exemple : Ajout du champ "Ã©conomie sociale et solidaire" lors d'une Ã©volution mineure par l'Insee.

                  - la transformation de la structure de l'API par le fournisseur de la donnÃ©e ;

                    {:.fr-highlight.fr-highlight--example}
                    > Par exemple : Sortie d'une Ã©volution majeure chez le fournisseur donnÃ©e.

                  - l'ajout d'une fonctionnalitÃ© par API&nbsp;Entreprise

                    {:.fr-highlight.fr-highlight--example}
                    > Par exemple : DÃ©livrance d'un nouveau champ "Certification valide" pour une API qui ne renvoyait avant que l'URL de tÃ©lÃ©chargement de l'attestation.

                  Pour comprendre comment monter en version, [consultez la rubrique suivante](#changer-de-version).

                  {:.fr-h5}
                  #### Les anciennes versions maintenues tant que le fournisseur de la donnÃ©e le permet

                  Depuis la V.3 de l'API&nbsp;Entreprise, les anciennes versions sont maintenues par le service API Entreprise tant que cela est possible.
                  En pratique, cela signifie que :
                  - tant que le fournisseur continue d'envoyer la strcuture de donnÃ©es de l'ancienne version, cette ancienne version est maintenue par l'API&nbsp;Entreprise ;
                  - si le fournisseur ne renvoie plus la mÃªme structure de donnÃ©e, API&nbsp;Entreprise supprimera l'ancienne version car la maintenir reviendrait Ã  renvoyer des champs vides.

              - title: Changer de version
                anchor: 'changer-de-version'
                content: |+
                  Depuis la version 3 de l'API&nbsp;Entreprise, toutes les API peuvent Ã©voluer indÃ©pendamment les unes des autres. Les anciennes versions (Ã  partir de la V.3) restent donc toujours disponibles si le fournisseur de la donnÃ©e continue de transmettre les informations.
                  Depuis la version 3, le numÃ©ro de version est un paramÃ¨tre de lâ€™appel et non plus une valeur fixe pour toutes les API comme en version 1 et 2 (Les versions 1 et 2 sont dÃ©finitivement dÃ©prÃ©ciÃ©es, la version 1 Ã©tant dÃ©jÃ  fermÃ©e et **la version 2 fermant le 30 juin 2023**).

                  >_Exemple d'utilisation du paramÃ¨tre d'appel de version :_
                  > Imaginons un exemple fictif : l'API documents, cette API est disponible en v.3 et une nouvelle version est sortie, la V.4.
                  > Pour appeler la version souhaitÃ©e, il vous faudra directement inscrire le numÃ©ro de la version dans l'URL : `https://entreprise.api.gouv.fr/v3/...` pour la V.3 ou `https://entreprise.api.gouv.fr/v4/...` pour la V.4.

                  {:.fr-highlight}
                  ğŸ“© Une lettre d'information annonce systÃ©matiquement les nouvelles Ã©volutions. Vous pouvez vous abonner [ici](<%= newsletter_path %>).
              - title: Surveiller l'Ã©tat des fournisseurs
                anchor: 'surveillance-etat-fournisseurs'
                content: |+
                  API Entreprise met Ã  disposition un ensemble de routes de "pings" permettant de rÃ©cupÃ©rer l'Ã©tat des services fournis par les diffÃ©rents fournisseurs de donnÃ©es.
                  L'ensemble des routes est disponible Ã  l'adresse suivante: [Routes de pings (format JSON)](https://entreprise.api.gouv.fr/pings).

                  Pour chacune de ces routes, l'Ã©quipe d'API Entreprise effectue des vÃ©rifications spÃ©cifiques au fournisseur, permettant d'Ãªtre au plus prÃ¨s de la rÃ©alitÃ© quand Ã  la santÃ© dudÃ®t fournisseur.
                  Chacune de ces routes renvoi un json sous le format suivant:

                  ```json
                  {
                    "status": "ok",
                    "last_update": "2023-11-03T12:24:07.185+01:00",
                    "last_ok_status": "2023-11-03T12:24:07.185+01:00"
                  }
                  ```

                  Avec:
                  - `status`, `string`, qui peut avoir 3 valeurs: `ok` quand tout est OK, `bad_gateway` quand il y a un souci, `unknown` quand on ne peut pas dÃ©terminer le status ;
                  - `last_update`, `datetime`, date de la derniÃ¨re mise Ã  jour: pour Ã©viter de surcharger nos systÃ¨mes nous effectuons de la mise en cache sur les pings ;
                  - `last_ok_update`, `datetime`, date de la derniÃ¨re mise Ã  jour en OK: permet de savoir depuis quand le service est en dÃ©faut.

                  A noter que le status http est Ã  200 pour `ok` et `unknown`, 502 pour `bad_gateway` : cela permet Ã  nos systÃ¨mes de monitoring de ne pas lever d'alertes en cas de donnÃ©es insuffisantes (et ainsi Ã©viter des potentiels faux positifs).

                  Nous vous conseillons de passer par ces routes de surveillances, et ceci pour plusieurs raisons:

                  1. API Entreprise s'occupe de la complexitÃ© vis-Ã -vis de la disponibilitÃ© de certains partenaires (limitation sur le nombre d'appels sur certains identifiants, Ã©checs alÃ©atoires etc..) ;
                  2. Il n'y a pas de limitations sur ces routes
                  3. L'implÃ©mentation est plus simple que d'utiliser les routes officieles
                  4. Un `bad gateway` d'une route de ping a de forte chance d'Ãªtre un vrai positif, contrairement Ã  un Ã©chec sur les endpoints qui peut Ãªtre dÃ» Ã  des erreurs rÃ©seaux/temporaires.

              - title: Retrouver les droits d'un jeton JWT
                anchor: 'retrouver-les-droits-dun-jeton-jwt'
                content: |+
                  Pour connaÃ®tre **la liste des APIs auxquelles vous avez le droit** avec votre jeton d'accÃ¨s, vous pouvez le vÃ©rifier avec l'API `/privileges`.

                  Si vous gÃ©rez les tokens pour vos utilisateurs, vous pouvez aussi utiliser cette API pour vÃ©rifier les droits associÃ©s Ã  leurs tokens.

                  {:.fr-h5}
                  #### La requÃªte HTTP :

                  ```
                  https://entreprise.api.gouv.fr/v2/privileges?token=LeTokenATester
                  ```

                  Le paramÃ¨tre d'appel Ã  renseigner est le token dont vous souhaitez connaÃ®tre les droits.

                  > **Exemple de rÃ©ponse JSON :**
                  >```
                  >{
                  >  "privileges": [
                  >    "attestations_agefiph",
                  >    [...]
                  >    "actes_bilans_inpi"
                  >  ]
                  >}
                  > ```

                  La rÃ©ponse JSON renvoie la liste des API autorisÃ©es. Retrouvez-leurs spÃ©cifications techniques dans le [Swagger](<%= developers_openapi_path %>){:target="_blank_"}.

          - anchor: 'kit-de-mise-en-production'
            title: Kit de mise en production&nbsp;ğŸš€
            subsections:
              - title: Tester l'API en prÃ©production
                anchor: 'tester-api-preproduction'
                content: |+
                  {:.fr-text--lg}
                  L'API&nbsp;Entreprise propose un environnement de test ou bac Ã  sable pour vous permettre de tester le branchement de l'API avec votre systÃ¨me d'informations. 
                  
                  {:.fr-highlight}
                  > ğŸ’¡ L'environnement de test est une fonctionnalitÃ© Ã  destination des usagers techniques. Si vous Ãªtes un profil mÃ©tier, veuillez vous rÃ©fÃ©rer aux fiches mÃ©tier de chaque API disponibles depuis le [catalogue](<%= endpoints_path %>).

                  {:.fr-text--lg}
                  **Les informations essentielles du bac Ã  sable :**

                  - **Une URL :** L''environnement de staging est appelable avec `https://staging.entreprise.api.gouv.fr`.

                  - **Les jetons d'accÃ¨s** : Pour Ãªtre fidÃ¨le au fonctionnement de l'API en production, cet environnement de test nÃ©cessite aussi un jeton d'accÃ¨s, mais celui-ci, contrairement aux [jetons de production](#rÃ©cupÃ©rer-le-jeton-jwt), est public car la donnÃ©e renvoyÃ©e en bac Ã  sable est fictive. Un jeton ayant tous les droits est accessible [ici](https://github.com/etalab/siade_staging_data/blob/develop/tokens/default){:target="_blank"}. Pour gÃ©nÃ©rer un jeton spÃ©cifique, veuillez vous rÃ©fÃ©rer Ã  ce [tutoriel](https://github.com/etalab/siade_staging_data/tree/develop/tokens){:target="_blank"}.
                  
                  - **Les donnÃ©es fictives de rÃ©ponse :** Les donnÃ©es retournÃ©es par cet environnement de test sont totalement fictives et disponibles depuis [ce dÃ©pÃ´t](https://github.com/etalab/siade_staging_data/tree/develop/payloads){:target="_blank"}.

                  - **Pour rappel, le fichier OpenAPI est disponible depuis le [swagger](<%= developers_openapi_path %>)**, avec le bouton "Download" situÃ© en dÃ©but de page.

                  **Pour en savoir plus, veuillez consulter le [README du dÃ©pÃ´t Github](https://github.com/etalab/siade_staging_data){:target="_blank"}.**

              - title: RÃ©cupÃ©rer le jeton JWT&nbsp;ğŸ”‘
                anchor: 'rÃ©cupÃ©rer-le-jeton-jwt'
                content: |+
                  Seule la personne ayant fait la demande d'habilitation a accÃ¨s au token, au travers du [compte utilisateur API&nbsp;Entreprise](<%= authorization_requests_path %>){:target="_blank"}.

                  - _Si vous avez rÃ©alisÃ© la demande d'habilitation_, vous pouvez **rÃ©cupÃ©rer vos tokens ou jetons d'accÃ¨s directement depuis votre [compte](<%= authorization_requests_path %>){:target="_blank"}**.

                  - _Si vous n'avez pas rÃ©alisÃ© la demande d'habilitation mais que vous Ãªtes la personne en charge d'intÃ©grer l'API&nbsp;Entreprise_, **la personne ayant effectuÃ© la demande d'habilitation peut vous transmettre le token de faÃ§on sÃ©curisÃ©e depuis son [compte](<%= authorization_requests_path %>){:target="_blank"}**, en cliquant sur le bouton _"Transmettre le jeton Ã  mon Ã©quipe technique"_. Vous recevrez alors, **par e-mail, un lien d'une durÃ©e de 4 heures** vous donnant accÃ¨s au jeton.

                  {:.fr-highlight.fr-highlight--caution}
                  > âš ï¸ L'utilisation de cette fonctionnalitÃ© du compte utilisateur doit avoir pour unique objectif la transmission sÃ©curisÃ©e de la clÃ© aux services techniques qui intÃ©greront l'API&nbsp;Entreprise. **Le jeton JWT ne doit jamais Ãªtre transmis par e-mail.**

              - title: Faire sa premiÃ¨re requÃªte
                anchor: 'faire-sa-premiÃ¨re-requÃªte'
                content: |+
                  #### Utiliser l'environnement de production - _Swagger_

                  AprÃ¨s avoir rÃ©cupÃ©rÃ© votre jeton, vous pouvez faire un premier appel de test.

                  Utilisez l'[environnement de production documentÃ© (_Swagger_)](https://api.gouv.fr/documentation/api-entreprise}{:target="_blank"}), disponible sur api.gouv.fr.
                  Il permet, Ã  l'aide d'un token d'authentification valide ğŸ”‘, d'effectuer directement depuis le navigateur des tests de l'API. Les donnÃ©es confidentielles restent bien protÃ©gÃ©es. Vous y trouverez aussi la spÃ©cification technique tÃ©lÃ©chargeable sous format YAML afin de pouvoir accÃ©lÃ©rer le dÃ©veloppement de vos outils d'interfaÃ§age avec API&nbsp;Entreprise.

                  {:.fr-highlight.fr-highlight--caution}
                  > âš ï¸ Attention, pour rappel, vous ne devez jamais copier-coller un token dans la barre de recherche classique d'un moteur de recherche ou dans un e-mail. Pour rÃ©cupÃ©rer votre jeton de faÃ§on sÃ©curisÃ©e, consultez cette [rubrique](<%= faq_index_path(anchor: 'comment-transmettre-le-jeton-d-acces-en-tout-securite') %>){:target="_blank"}.


                  #### Ã‰lÃ©ments constitutifs de la requÃªte HTTP d'API&nbsp;Entreprise

                  Chaque URL de requÃªte est spÃ©cifiÃ©e dans le [Swagger](<%= developers_openapi_path %>){:target="_blank_"},

                  {:.fr-h6}
                  ##### Exemple de requÃªte :

                  ```
                  https://entreprise.api.gouv.fr/v3/attestation_fiscales_dgfip/SirenDeLâ€™Entreprise?token=ğŸ“&user_id=ğŸ“&context=ğŸ“&recipient=ğŸ“&object=ğŸ“
                  ```

                  {:.fr-table}
                  | Ã‰lÃ©ments composant la requÃªte              |   Ã‰tat    | Exemples      |
                  |--------------------------------------------|-----------|---------------|
                  |**Domaine** <br>(ou prÃ©fixe) <br>qui conduit Ã  l'API de faÃ§on sÃ©curisÃ©e| prÃ©dÃ©fini par endpoint|`https://entreprise.api.gouv.fr`|
                  |**NumÃ©ro de la version** <br>(par dÃ©faut dÃ©sormais en V3)| prÃ©dÃ©fini par endpoint| `/v3`|
                  |**Nom de la donnÃ©e recherchÃ©e** <br>(ou *endpoint*)| prÃ©dÃ©fini par endpoint| `/attestation_fiscale_dgfip`|
                  |**IdentitÃ© de l'Ã©tablissement concernÃ©** <br>(souvent SIREN ou SIRET)| Ã  choisir ğŸ“|`/SIRENouSIRETdeL'Etablissement`|
                  |**Votre jeton d'accÃ¨s**| Ã  renseigner ğŸ“|`?token=JetonD'Habilitation`|
                  |**Des paramÃ¨tres de traÃ§abilitÃ©**| Ã  renseigner ğŸ“| `&context=CadreDeLaRequÃªte`<br> â„¹ï¸ Plus d'informations disponibles dans la partie [Instruire les paramÃ¨tres de traÃ§abilitÃ©](<%= developers_path(anchor: 'renseigner-les-paramÃ¨tres-dappel-et-de-traÃ§abilitÃ©') %>){:target="_blank"}|

                  #### Constatez votre premiÃ¨re trace dâ€™appel depuis le compte utilisateur

                  Une fois que vous avez fait un premier appel, celui-ci est **rÃ©pertoriÃ©** dans votre [compte utilisateur](<%= authorization_requests_path %>){:target="_blank"}, dans la page dÃ©taillÃ©e de l'habilitation concernÃ©e, au niveau du jeton. Un lien vous permet d'accÃ©der aux statistiques.

              - title: Configurer le logiciel mÃ©tier
                anchor: 'configurer-le-logiciel-mÃ©tier'
                content: |+
                  Documentation en construction&nbsp;ğŸš§

              - title: Monitorer la disponibilitÃ© des API
                anchor: 'monitorer-la-disponibilitÃ©-des-api'
                content: |+
                  DÃ¨s l'intÃ©gration d'API Entreprise, prenez un temps pour vous assurer d'Ãªtre informÃ© de la disponibilitÃ© de nos API&nbsp;:
                  - Ajoutez des routes de pings pour automatiser la surveillance des API par vous-mÃªme. Pour en savoir plus, consulter la rubrique [_"surveiller l'Ã©tat des fournisseurs"_](<%= developers_path(anchor: 'surveillance-etat-fournisseurs') %>) ;
                  - abonnez-vous aux incidents et opÃ©rations de maintenance directement depuis notre [page de statut](https://status.entreprise.api.gouv.fr/){:target="_blank"}.

          - anchor: 'incidents-et-maintenances'
            title: Incidents et maintenances&nbsp;ğŸš§
            subsections:
              - title: Que faire en cas de rupture de service ?
                anchor: 'que-faire-en-cas-de-rupture-de-service-'
                content: |+
                  Le service ne rÃ©pond plus ? consultez [cette rubrique de notre FAQ](<%= faq_index_path(anchor: 'le-service-ne-repond-plus-que-faire') %>){:target="_blank"}.

              - title: ÃŠtre informÃ© des ruptures de service
                anchor: 'Ãªtre-informÃ©-des-ruptures-de-service'
                content: |+
                  1. **Abonnez-vous aux notifications** par e-mail depuis [notre page de statut](https://status.entreprise.api.gouv.fr/subscribe/email){:target="_blank"}.

                  2. **Ajoutez des routes de pings pour automatiser la surveillance** des API par vous-mÃªme. PlutÃ´t que de consulter ponctuellement notre page de statuts, vous pouvez vous branchez directement Ã  nos routes afin d'avoir un suivi encore plus prÃ©cis. Pour en savoir plus, consulter la rubrique [surveiller l'Ã©tat des fournisseurs](<%= developers_path(anchor: 'surveillance-etat-fournisseurs') %>).

          - anchor: 'prolongation-du-jwt'
            title: Prolongation de la durÃ©e de vie du JWT&nbsp;ğŸ”‘
            content: >-
              Pour comprendre comment prolonger votre jeton, consultez [cette rubrique de notre FAQ](<%= faq_index_path(anchor: 'comment-prolonger-mon-jeton-arrivant-a-expiration') %>){:target="_blank"}.

