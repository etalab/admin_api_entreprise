---
fr:
  api_entreprise:
    documentation_pages:
      developers:
        title: Espace d√©veloppeurs&nbsp;üõ†
        sections:
          - anchor: 'prerequis-techniques'
            title: Pr√©requis techniques
            content: |+
              Voici la liste des **fondamentaux techniques √† mettre en place pour le bon fonctionnement de l‚ÄôAPI&nbsp;Entreprise**&nbsp;:

              - ‚òëÔ∏è √ätre en mesure de g√©rer le protocole HTTPS ;
              - ‚òëÔ∏è Avoir une version de langage r√©cente. Si vous utilisez Java, une version >= 1.8 est n√©cessaire (pour la gestion des certificats de +1024 bit, du TLS 1.2 minimum et des suites cryptographiques - ciphers) ;
              - ‚òëÔ∏è S‚Äôassurer que nos Autorit√©s de Certification (AC) pour les certificats SSL sont autoris√©es par vos syst√®mes ;
              - ‚òëÔ∏è L'API&nbsp;Entreprise est uniquement accessible par internet. Si vous avez un pare-feu, il faut donc pr√©voir de whitelister l'adresse IP du service API Entreprise ;
              - ‚òëÔ∏è Il est interdit d'interroger l'API&nbsp;Entreprise depuis un site web en front-end, car le jeton d'acc√®s serait alors divulgu√©. Il vous faut donc interroger nos API depuis une application en back-end. Nous n'autoriserons pas le CORS (CORS - Cross Origin Ressource Sharing) ;
              - ‚òëÔ∏è Pr√©voir non seulement les co√ªts de d√©veloppement mais √©galement les co√ªts de maintenance ;
              - ‚òëÔ∏è √ätre en capacit√© de g√©rer les mises √† jour de l'API&nbsp;Entreprise.

              <br>
              üí° Pour mieux comprendre l'API&nbsp;Entreprise avant de demander un acc√®s, **vous pouvez utiliser [notre environnement de test](<%= developers_path(anchor: 'tester-api-preproduction') %>)**.

          - anchor: 'specifications-generales'
            title: Sp√©cifications g√©n√©rales&nbsp;üéõ
            subsections:
              - title: Respecter la volum√©trie
                anchor: 'respecter-la-volum√©trie'
                content: |+
                  #### Les plafonds

                  Les limites de volum√©trie sur API&nbsp;Entreprise se d√©composent en deux r√®gles principales&nbsp;:&nbsp;

                  - **Un plafond g√©n√©ral par IP de 1000 requ√™tes/minute**.

                  - **Une volum√©trie par jeton par groupe d‚Äôendpoints&nbsp;:**
                        - **1er groupe**&nbsp;:&nbsp;Les endpoints renvoyant du JSON constituent un premier groupe. Vous pouvez effectuer jusqu‚Äô√† 250 requ√™tes/min/jeton sur ce groupe.
                        - **2√®me groupe**&nbsp;:&nbsp;Les endpoints transmettant des documents constituent un autre groupe. La volum√©trie maximale d‚Äôappel concernant ce groupe est de 50 requ√™tes/min/jeton.
                        - **Exceptions**&nbsp;:&nbsp;Certains endpoints √©chappent √† cette r√®gle et pr√©sentent une volum√©trie sp√©cifique par endpoint. Il s'agit notamment de l‚Äô[API attestation fiscale de la DGFIP](<%= developers_openapi_path(anchor: 'tag/Attestations-sociales-et-fiscales/paths/~1v4~1dgfip~1unites_legales~1{siren}~1attestation_fiscale/get') %>){:target="_blank"}, de l'[API d√©pr√©ci√©e Actes de l‚ÄôINPI](<%= developers_openapi_path(anchor: 'tag/Informations-generales/paths/~1v3~1inpi~1unites_legales~1{siren}~1actes/get') %>){:target="_blank"}{:target="_blank"} ou encore des [API effectifs du GIP-MDS](<%= developers_openapi_path(anchor: 'tag/Informations-generales/paths/~1v3~1gip_mds~1unites_legales~1{siren}~1effectifs_annuels~1{year}/get') %>){:target="_blank"}. Comme pour toutes les API du bouquet, la volum√©trie exacte figure dans le header.

                  #### Informations volum√©trie dans le header

                  ##### Pour toutes les r√©ponses&nbsp;:

                  Dans toutes les r√©ponses de nos API, le header vous transmet des informations sur la volum√©trie&nbsp;:

                  {:.fr-table}
                  | Champs du header    |   Signification    |     Format           |
                  |:------------------------------|:------------------|:------------:|
                  | `RateLimit-Limit` |La **limite** concernant l'endpoint appel√©, soit le nombre de requ√™te/minute. | Nombre|
                  | `RateLimit-Remaining` |Le **nombre d'appels restants** durant la p√©riode courante d'une minute. | Nombre |
                  | `RateLimit-Reset` |La **fin de la p√©riode** courante. | Timestamp |

                  {:.fr-highlight.fr-highlight--example}
                  >**Exemple&nbsp;:**
                  >Consid√©rons un endpoint ayant une limite de 50 appels /minute.
                  >Vous fa√Ætes un premier appel √† 10h00 pile, et effectuez un second appel 20 secondes plus tard, puis un troisi√®me 10 secondes plus tard, vous aurez les valeurs suivantes :
                  > - `RateLimit-Limit` : 50 ;
                  > - `RateLimit-Remaining` : 47 (50 moins les 3 appels effectu√©s) ;
                  > - `RateLimit-Reset` : [*Timestamp correspondant au jour pr√©sent √† 10h01*]. Le premier appel initialise le compteur (√† 10h00 pile), la p√©riode se termine 1min plus tard.
                  >
                  > Vous pouvez donc jusqu'√† 10h01 pile effectuer 47 appels, le compteur sera r√©initialis√© √† 50 √† ce moment-l√†.

                  ##### En cas de d√©passement :

                  Si vous d√©passez le nombre d'appels autoris√©s (`RateLimit-Remaining = 0`), le serveur r√©pondra avec le `status 429` sur tous les appels suivants dans la m√™me p√©riode.

                  Le header associ√© √† ce code erreur `429` sera accompagn√©&nbsp;:&nbsp;
                  - des trois champs pr√©c√©dents ;
                  - d'un champ suppl√©mentaire indiquant le temps √† attendre avant de pouvoir effectuer des nouveaux appels.

                  {:.fr-table}
                  | Champs du header    |   Signification    |     Format           |
                  |:------------------------------|:------------------|:------------:|
                  | `RateLimit-Limit` |La **limite** concernant l'endpoint appel√©, soit le nombre de requ√™te/minute. | Nombre|
                  | `RateLimit-Remaining` |Le **nombre d'appels restants** durant la p√©riode courante d'une minute. | Nombre |
                  | `RateLimit-Reset` |La **fin de la p√©riode** courante. | Timestamp |
                  | *Uniquement pour le header associ√© au code erreur 429* <br> `Retry-after`| **D√©compte du nombre de secondes restantes** avant la prochaine p√©riode | Secondes |

                  Vous pouvez donc **utiliser les champs du header pour optimiser votre consommation de l'API&nbsp;Entreprise**.

                  #### R√®gles de bannissement en cas de surconsommation

                  En cas de non prise en compte des codes erreurs `429` ou en cas de d√©passement de la limite de volum√©trie globale, **votre IP sera temporairement bannie de nos serveurs pour une dur√©e fixe et non r√©vocable de 12h**. Si vous avez plusieurs jetons, tous seront donc bloqu√©s pendant ce laps de temps.

                  Les appels depuis une IP bannie ne renvoient pas de codes HTTP, le serveur ne r√©pond tout simplement pas.
                  Vous pouvez en revanche v√©rifier si vous avez d√©pass√© ce seuil depuis votre [compte utilisateur](<%= authorization_requests_path %>){:target="_blank"}.

                  {:.fr-highlight}
                  > ‚ÑπÔ∏è Au bout de ces 12 heures, vos acc√®s sont automatiquement r√©tablis ; **il est donc inutile d'√©crire au support**.

                  Nous vous invitons √† prendre les mesures n√©cessaires car le d√©passement intervient g√©n√©ralement chez nos utilisateurs lorsque leur programme n'a pas √©t√© correctement configur√©.

                  Pour les appels de traitement de masse, il est souhaitable que vous fassiez vos **batchs automatiques la nuit ou durant les heures creuses** afin de ne pas affecter la qualit√© du service pour le reste des usagers.

              - title: Configurer vos timeout
                anchor: 'configurer-vos-timeout'
                content: |+
                  Le timeout est le temps d'attente maximal de r√©ponse √† une requ√™te. Il vous permet de ne pas immobiliser votre logiciel en le laissant bloqu√© sur un appel sans r√©ponse.

                  De fa√ßon g√©n√©rale, nous vous recommandons un timeout&nbsp;:&nbsp;
                  - de **5 secondes** pour les appels de donn√©es structur√©es JSON ;
                  - de **12 secondes** pour les appels retournant un PDF ou un ZIP.

                  De m√™me, pour ne pas immobiliser nos serveurs, nous attendons les r√©ponses de nos fournisseurs un maximum de 10 secondes avant de vous les retransmettre. Si ce d√©lai d‚Äôattente est d√©pass√© un code erreur HTTP `504` vous sera renvoy√©.

              - title: Autoriser nos Autorit√©s de Certifications
                anchor: 'autoriser-nos-autorit√©s-de-certifications'
                content: |+
                  API&nbsp;Entreprise utilise [DHIMYOTIS](https://www.dhimyotis.com/) comme organisme de d√©livrance de ses certificats SSL principaux ainsi que [Let's Encrypt](https://letsencrypt.org/) pour certains services secondaires.

                  Il est conseill√© d'ajouter ces Autorit√©s de Certifications (AC) √† votre base de confiance si vous en avez une. Une solution id√©ale est d'utiliser un paquet d'autorit√©s mises √† jour automatiquement ([Mozilla par exemple](https://wiki.mozilla.org/CA/Included_Certificates))

                  API&nbsp;Entreprise utilise des certificats multi-domaines ; c'est-√†-dire avec un "nom courant" (_common name - CN_) et plusieurs "noms alternatifs du sujet" (_subject alternatives names - SAN_), **soyez certains que vos outils fonctionnent correctement avec**.

              - title: G√©rer les erreurs - codes HTTPS
                anchor: 'g√©rer-les-erreurs---codes-https'
                content: |+
                  #### Un code standard HTTPS pour cat√©goriser le statut de l'appel
                  Toutes les r√©ponse de l‚ÄôAPI&nbsp;Entreprise sont envoy√©es avec un code HTTPS. **Ces codes permettent de se renseigner sur le statut de l‚Äôappel**, et sont harmonis√©s pour l'ensemble des API quelque soir le fournisseur de donn√©es.
                  Pour en savoir plus sur les codes HTTPS, cet article de [Wikipedia](https://fr.wikipedia.org/wiki/Liste_des_codes_HTTP){:target="_blank"} constitue une bonne base explicative.

                  ##### En cas de succ√®s, le code HTTP commence par 2 :

                  {:.fr-table}
                  | Code HTTPS                                       |      Signification                 |
                  |--------------------------------------------------|------------------------------------|
                  |`200` | **Tout va bien.**|

                  ##### En cas d‚Äô√©chec, si l‚Äôerreur vient de votre c√¥t√©, le code HTTP commence par 4 :

                  {:.fr-table}
                  | Code HTTP                       |      Signification                     |
                  |---------------------------------|----------------------------------------|
                  |`400` | **Mauvaise requ√™te** ‚Äì La syntaxe de votre requ√™te est erron√©e.|
                  |`401` | **Non autoris√©** ‚Äì Votre token est invalide ou manquant.|
                  |`403` | **Interdit** ‚Äì Le serveur a compris votre requ√™te mais refuse de l‚Äôex√©cuter car votre jeton ne vous donne pas acc√®s √† cette ressource.|
                  |`404` | **Non trouv√©** ‚Äì La ressource (l'entreprise, le certificat, ‚Ä¶) demand√©e n'a pas √©t√© trouv√©e. Cette erreur intervient par exemple lors de l‚Äôentr√©e d‚Äôun num√©ro de SIREN qui n‚Äôexiste pas, ou bien lorsque l‚Äôentreprise qu‚Äôil designe est en dehors du p√©rim√®tre de l‚Äôendpoint.|
                  |`422` | **Entit√© non traitable** ‚Äì Le format de la donn√©e pass√©e en param√®tre n'est pas accept√©. Par exemple, si vous entrez 20 chiffres dans le param√®tre SIREN, votre requ√™te est automatiquement rejet√©e, car un SIREN fait obligatoirement 9 chiffres.|
                  |`451` | **Indisponible pour raisons l√©gales** - ce code est sp√©cifiquement renvoy√© lorsque vous demandez les informations d‚Äôune entreprise ou d‚Äôun √©tablissement non diffusible au travers des endpoints `entreprises` et `etablissements` de l‚ÄôINSEE, sans avoir utilis√© l‚Äôoption d‚Äôappel sp√©cifique. Pour en savoir plus, [consultez la documentation de cet endpoint dans le catalogue de donn√©es](../catalogue/).|


                  ###### En cas d‚Äô√©chec, si l‚Äôerreur provient d‚ÄôAPI&nbsp;Entreprise ou bien des fournisseurs de donn√©es, le code HTTP commence par 5 :

                  {:.fr-table}
                  | Code HTTP                        |      Signification                     |
                  |----------------------------------|----------------------------------------|
                  |`500` | **Erreur interne √† API&nbsp;Entreprise** ‚Äì Une erreur interne du serveur d‚ÄôAPI&nbsp;Entreprise est survenue. [Consultez votre compte utilisateur](<%= authorization_requests_path %>){:target="_blank"}, l‚Äôhistorique de l‚Äôincident devrait y √™tre affich√© ; ainsi que les actions √† venir.
                  |`502` | **Erreur interne fournisseur** ‚Äì Une erreur interne du serveur du ou des fournisseurs est survenue. [Consultez votre compte utilisateur](<%= authorization_requests_path %>){:target="_blank"}, l‚Äôhistorique de l‚Äôincident devrait y √™tre affich√© ; ainsi que les actions √† venir.
                  |`503` | **Service non disponible** ‚Äì Le service est temporairement indisponible ou en maintenance. Pour conna√Ætre l‚Äôhistorique de disponibilit√© et les incidents type de l‚Äôendpoint, vous pouvez [consulter le catalogue de donn√©es](../catalogue/).
                  |`504` | **Interm√©diaire hors d√©lai** ‚Äì Le(s) producteur(s) de donn√©es ont mis trop de temps √† r√©pondre. Notre temps d‚Äôattente, nous permettant de ne pas immobiliser le serveur sur un appel sans r√©ponse, est fix√© √† 10 secondes et a √©t√© d√©pass√©.|


                  #### Un code suppl√©mentaire pour pr√©ciser l'erreur et enclencher une action

                  Tous les codes erreur HTTPS sont accompagn√©s de **codes plus pr√©cis, sp√©cifiques √† chaque situation d‚Äôerreur**. Une explication en toutes lettres est √©galement donn√©e dans la payload. Enfin, dans certains cas, une m√©tadonn√©e actionnable est disponible.

                  Dans l‚Äôexemple ci-dessous, la cl√© `retry_in` permet justement de relancer un appel apr√®s le nombre de secondes indiqu√©es.

                  >_Exemple de payload d'un code HTTPS 502 :_
                  >```
                  >{
                  >    "errors": [
                  >       {
                  >            "code": "04501",
                  >            "title": "Analyse de la situation du compte en cours",
                  >            "detail": "La situation de l'entreprise requiert une analyse manuelle d'un agent de l'URSSAF. Une >demande d'analyse vient d'√™tre envoy√©e, cela prend au maximum 2 jours.",
                  >            "meta": {
                  >                "provider": "ACOSS",
                  >                "retry_in": 172800
                  >           }
                  >        }
                  >    ]
                  >}
                  >```


                  Retrouvez tous les codes erreurs pour chaque endpoint dans [notre swagger, partie "Response samples"](<%= developers_openapi_path %>){:target="_blank"}.
                  La liste des codes sp√©cifiques √† chaque endpoint y est disponible.


              - title: Renseigner les param√®tres d'appel et de tra√ßabilit√©
                anchor: 'renseigner-les-param√®tres-dappel-et-de-tra√ßabilit√©'
                content: |+
                  API&nbsp;Entreprise vous permet d‚Äôacc√©der √† des donn√©es prot√©g√©es. C‚Äôest pourquoi, dans un **objectif de tra√ßabilit√©**, nous vous demandons de renseigner dans chacune de vos requ√™tes, non seulement un jeton d‚Äôacc√®s, mais aussi **certaines informations qualifiant votre requ√™te**.


                  {:.fr-highlight.fr-highlight--caution}
                  > ‚ö†Ô∏è **Ces param√®tres sont obligatoires**. Les appels ne comportant pas ces param√®tres sont rejet√©s, et un code erreur vous est renvoy√©.


                  Pour chaque endpoint, nous pr√©cisons dans le [swagger, rubrique "Query parameters"](<%= developers_openapi_path %>){:target="_blank"} les param√®tres obligatoires sp√©cifiques, ci-dessous une explication d√©taill√©e des √©l√©ments √† fournir pour chaque param√®tre de tra√ßabilit√© :

                  {:.fr-table}
                  | Param√®tre                                                  |      Information √† renseigner           |
                  |:----------------------------------------------------------:|-----------------------------------------|
                  |`&context=CadreDeLaRequ√™te`|**Le cadre de la requ√™te** <br><br>Par exemple : aides publiques, march√©s publics ou gestion d'un r√©f√©rentiel tiers utilis√© pour tel type d'application*.*
                  |`&recipient=B√©n√©ficaireDeL'Appel`|**Le b√©n√©ficiaire de l'appel** <br><br>Ce param√®tre permet la tra√ßabilit√© de l'appel et doit correspondre au _SIRET de l'organisation publique habilit√©e √† utiliser la donn√©e_. <br><br>Si vous √™tes une collectivit√© ou une administration, ce param√®tre doit donc √™tre votre num√©ro de SIRET. Si vous √™tes un √©diteur, il s'agit du SIRET de l'organisation publique cliente demandant la donn√©e.<br><br>Une v√©rification est effectu√©e par API Entreprise pour refuser tout format qui ne serait pas un num√©ro de SIRET et pour refuser un SIRET qui serait identique √† l'entit√© appel√©e.
                  |`&object= RaisonDeL'AppelOuIdentifiant`|**La raison de l'appel** <br> ou l'identifiant de la proc√©dure. <br><br> L'identifiant peut √™tre interne √† votre organisation ou bien un num√©ro de march√© publique, un nom de proc√©dure ; l'essentiel est que celui-ci vous permette de tracer et de retrouver les informations relatives √† l'appel. En effet, vous devez pouvoir justifier de la raison d'un appel aupr√®s du fournisseur de donn√©es. <br> Description courte (< 50 caract√®res).

              - title: G√©rer les √©volutions de version
                anchor: 'gerer-les-evolutions-de-version'
                content: |+
                  Il est fr√©quent que les API √©voluent et que, par cons√©quent, de nouvelles versions soient publi√©es.
                  La version majeure V.3 de l'API&nbsp;Entreprise permet de cr√©er facilement de nouvelles versions, tout en gardant les pr√©c√©dentes, rendant ainsi accessibles rapidement les √©volutions qu'API Entreprise obtient de ses fournisseurs.

                  {:.fr-h5}
                  #### Toute √©volution implique une mont√©e de version

                  Les mont√©s de version d'une API interviennent pour toute √©volution, c'est-√†-dire :
                  - l'ajout d'un nouveau champ par le fournisseur de la donn√©e ;

                    {:.fr-highlight.fr-highlight--example}
                    > Par exemple : Ajout du champ "√©conomie sociale et solidaire" lors d'une √©volution mineure par l'Insee.

                  - la transformation de la structure de l'API par le fournisseur de la donn√©e ;

                    {:.fr-highlight.fr-highlight--example}
                    > Par exemple : Sortie d'une √©volution majeure chez le fournisseur donn√©e.

                  - l'ajout d'une fonctionnalit√© par API&nbsp;Entreprise

                    {:.fr-highlight.fr-highlight--example}
                    > Par exemple : D√©livrance d'un nouveau champ "Certification valide" pour une API qui ne renvoyait avant que l'URL de t√©l√©chargement de l'attestation.

                  Pour comprendre comment monter en version, [consultez la rubrique suivante](#changer-de-version).

                  {:.fr-h5}
                  #### Les anciennes versions maintenues tant que le fournisseur de la donn√©e le permet

                  Depuis la V.3 de l'API&nbsp;Entreprise, les anciennes versions sont maintenues par le service API Entreprise tant que cela est possible.
                  En pratique, cela signifie que :
                  - tant que le fournisseur continue d'envoyer la strcuture de donn√©es de l'ancienne version, cette ancienne version est maintenue par l'API&nbsp;Entreprise ;
                  - si le fournisseur ne renvoie plus la m√™me structure de donn√©e, API&nbsp;Entreprise supprimera l'ancienne version car la maintenir reviendrait √† renvoyer des champs vides.

              - title: Changer de version
                anchor: 'changer-de-version'
                content: |+
                  Depuis la version 3 de l'API&nbsp;Entreprise, toutes les API peuvent √©voluer ind√©pendamment les unes des autres. Les anciennes versions (√† partir de la V.3) restent donc toujours disponibles si le fournisseur de la donn√©e continue de transmettre les informations.
                  Depuis la version 3, le num√©ro de version est un param√®tre de l‚Äôappel et non plus une valeur fixe pour toutes les API comme en version 1 et 2 (Les versions 1 et 2 sont d√©finitivement d√©pr√©ci√©es, la version 1 √©tant d√©j√† ferm√©e et **la version 2 fermant le 30 juin 2023**).

                  >_Exemple d'utilisation du param√®tre d'appel de version :_
                  > Imaginons un exemple fictif : l'API documents, cette API est disponible en v.3 et une nouvelle version est sortie, la V.4.
                  > Pour appeler la version souhait√©e, il vous faudra directement inscrire le num√©ro de la version dans l'URL : `https://entreprise.api.gouv.fr/v3/...` pour la V.3 ou `https://entreprise.api.gouv.fr/v4/...` pour la V.4.

                  {:.fr-highlight}
                  üì© Une lettre d'information annonce syst√©matiquement les nouvelles √©volutions. Vous pouvez vous abonner [ici](<%= newsletter_path %>).
              - title: Surveiller l'√©tat des fournisseurs
                anchor: 'surveillance-etat-fournisseurs'
                content: |+
                  API Entreprise met √† disposition un ensemble de routes de "pings" permettant de r√©cup√©rer l'√©tat des services fournis par les diff√©rents fournisseurs de donn√©es.
                  L'ensemble des routes est disponible √† l'adresse suivante: [Routes de pings (format JSON)](https://entreprise.api.gouv.fr/pings).

                  Pour chacune de ces routes, l'√©quipe d'API Entreprise effectue des v√©rifications sp√©cifiques au fournisseur, permettant d'√™tre au plus pr√®s de la r√©alit√© quand √† la sant√© dud√Æt fournisseur.
                  Chacune de ces routes renvoi un json sous le format suivant:

                  ```json
                  {
                    "status": "ok",
                    "last_update": "2023-11-03T12:24:07.185+01:00",
                    "last_ok_status": "2023-11-03T12:24:07.185+01:00"
                  }
                  ```

                  Avec:
                  - `status`, `string`, qui peut avoir 3 valeurs: `ok` quand tout est OK, `bad_gateway` quand il y a un souci, `unknown` quand on ne peut pas d√©terminer le status ;
                  - `last_update`, `datetime`, date de la derni√®re mise √† jour: pour √©viter de surcharger nos syst√®mes nous effectuons de la mise en cache sur les pings ;
                  - `last_ok_update`, `datetime`, date de la derni√®re mise √† jour en OK: permet de savoir depuis quand le service est en d√©faut.

                  A noter que le status http est √† 200 pour `ok` et `unknown`, 502 pour `bad_gateway` : cela permet √† nos syst√®mes de monitoring de ne pas lever d'alertes en cas de donn√©es insuffisantes (et ainsi √©viter des potentiels faux positifs).

                  Nous vous conseillons de passer par ces routes de surveillances, et ceci pour plusieurs raisons:

                  1. API Entreprise s'occupe de la complexit√© vis-√†-vis de la disponibilit√© de certains partenaires (limitation sur le nombre d'appels sur certains identifiants, √©checs al√©atoires etc..) ;
                  2. Il n'y a pas de limitations sur ces routes
                  3. L'impl√©mentation est plus simple que d'utiliser les routes officieles
                  4. Un `bad gateway` d'une route de ping a de forte chance d'√™tre un vrai positif, contrairement √† un √©chec sur les endpoints qui peut √™tre d√ª √† des erreurs r√©seaux/temporaires.

              - title: Retrouver les droits d'un jeton JWT
                anchor: 'retrouver-les-droits-dun-jeton-jwt'
                content: |+
                  Pour conna√Ætre **la liste des APIs auxquelles vous avez le droit** avec votre jeton d'acc√®s, vous pouvez le v√©rifier avec l'API `/privileges`.

                  Si vous g√©rez les tokens pour vos utilisateurs, vous pouvez aussi utiliser cette API pour v√©rifier les droits associ√©s √† leurs tokens.

                  {:.fr-h5}
                  #### La requ√™te HTTP :

                  ```
                  https://entreprise.api.gouv.fr/v2/privileges?token=LeTokenATester
                  ```

                  Le param√®tre d'appel √† renseigner est le token dont vous souhaitez conna√Ætre les droits.

                  > **Exemple de r√©ponse JSON :**
                  >```
                  >{
                  >  "privileges": [
                  >    "attestations_agefiph",
                  >    [...]
                  >    "actes_bilans_inpi"
                  >  ]
                  >}
                  > ```

                  La r√©ponse JSON renvoie la liste des API autoris√©es. Retrouvez-leurs sp√©cifications techniques dans le [Swagger](<%= developers_openapi_path %>){:target="_blank_"}.

          - anchor: 'kit-de-mise-en-production'
            title: Kit de mise en production&nbsp;üöÄ
            subsections:
              - title: Tester l'API en pr√©production
                anchor: 'tester-api-preproduction'
                content: |+
                  {:.fr-text--lg}
                  L'API&nbsp;Entreprise propose un environnement de test ou bac √† sable pour vous permettre de tester le branchement de l'API avec votre syst√®me d'informations. 
                  
                  {:.fr-highlight}
                  > üí° L'environnement de test est une fonctionnalit√© √† destination des usagers techniques. Si vous √™tes un profil m√©tier, veuillez vous r√©f√©rer aux fiches m√©tier de chaque API disponibles depuis le [catalogue](<%= endpoints_path %>).

                  {:.fr-text--lg}
                  **Les informations essentielles du bac √† sable :**

                  - **Une URL :** L''environnement de staging est appelable avec `https://staging.entreprise.api.gouv.fr`.

                  - **Les jetons d'acc√®s** : Pour √™tre fid√®le au fonctionnement de l'API en production, cet environnement de test n√©cessite aussi un jeton d'acc√®s, mais celui-ci, contrairement aux [jetons de production](#r√©cup√©rer-le-jeton-jwt), est public car la donn√©e renvoy√©e en bac √† sable est fictive. Un jeton ayant tous les droits est accessible [ici](https://github.com/etalab/siade_staging_data/blob/develop/tokens/default){:target="_blank"}. Pour g√©n√©rer un jeton sp√©cifique, veuillez vous r√©f√©rer √† ce [tutoriel](https://github.com/etalab/siade_staging_data/tree/develop/tokens){:target="_blank"}.
                  
                  - **Les donn√©es fictives de r√©ponse :** Les donn√©es retourn√©es par cet environnement de test sont totalement fictives et disponibles depuis [ce d√©p√¥t](https://github.com/etalab/siade_staging_data/tree/develop/payloads){:target="_blank"}.

                  - **Pour rappel, le fichier OpenAPI est disponible depuis le [swagger](<%= developers_openapi_path %>)**, avec le bouton "Download" situ√© en d√©but de page.

                  **Pour en savoir plus, veuillez consulter le [README du d√©p√¥t Github](https://github.com/etalab/siade_staging_data){:target="_blank"}.**

              - title: R√©cup√©rer le jeton JWT&nbsp;üîë
                anchor: 'r√©cup√©rer-le-jeton-jwt'
                content: |+
                  Seule la personne ayant fait la demande d'habilitation a acc√®s au token, au travers du [compte utilisateur API&nbsp;Entreprise](<%= authorization_requests_path %>){:target="_blank"}.

                  - _Si vous avez r√©alis√© la demande d'habilitation_, vous pouvez **r√©cup√©rer vos tokens ou jetons d'acc√®s directement depuis votre [compte](<%= authorization_requests_path %>){:target="_blank"}**.

                  - _Si vous n'avez pas r√©alis√© la demande d'habilitation mais que vous √™tes la personne en charge d'int√©grer l'API&nbsp;Entreprise_, **la personne ayant effectu√© la demande d'habilitation peut vous transmettre le token de fa√ßon s√©curis√©e depuis son [compte](<%= authorization_requests_path %>){:target="_blank"}**, en cliquant sur le bouton _"Transmettre le jeton √† mon √©quipe technique"_. Vous recevrez alors, **par e-mail, un lien d'une dur√©e de 4 heures** vous donnant acc√®s au jeton.

                  {:.fr-highlight.fr-highlight--caution}
                  > ‚ö†Ô∏è L'utilisation de cette fonctionnalit√© du compte utilisateur doit avoir pour unique objectif la transmission s√©curis√©e de la cl√© aux services techniques qui int√©greront l'API&nbsp;Entreprise. **Le jeton JWT ne doit jamais √™tre transmis par e-mail.**

              - title: Faire sa premi√®re requ√™te
                anchor: 'faire-sa-premi√®re-requ√™te'
                content: |+
                  #### Utiliser l'environnement de production - _Swagger_

                  Apr√®s avoir r√©cup√©r√© votre jeton, vous pouvez faire un premier appel de test.

                  Utilisez l'[environnement de production document√© (_Swagger_)](https://api.gouv.fr/documentation/api-entreprise}{:target="_blank"}), disponible sur api.gouv.fr.
                  Il permet, √† l'aide d'un token d'authentification valide üîë, d'effectuer directement depuis le navigateur des tests de l'API. Les donn√©es confidentielles restent bien prot√©g√©es. Vous y trouverez aussi la sp√©cification technique t√©l√©chargeable sous format YAML afin de pouvoir acc√©l√©rer le d√©veloppement de vos outils d'interfa√ßage avec API&nbsp;Entreprise.

                  {:.fr-highlight.fr-highlight--caution}
                  > ‚ö†Ô∏è Attention, pour rappel, vous ne devez jamais copier-coller un token dans la barre de recherche classique d'un moteur de recherche ou dans un e-mail. Pour r√©cup√©rer votre jeton de fa√ßon s√©curis√©e, consultez cette [rubrique](<%= faq_index_path(anchor: 'comment-transmettre-le-jeton-d-acces-en-tout-securite') %>){:target="_blank"}.


                  #### √âl√©ments constitutifs de la requ√™te HTTP d'API&nbsp;Entreprise

                  Chaque URL de requ√™te est sp√©cifi√©e dans le [Swagger](<%= developers_openapi_path %>){:target="_blank_"},

                  {:.fr-h6}
                  ##### Exemple de requ√™te :

                  ```
                  https://entreprise.api.gouv.fr/v3/attestation_fiscales_dgfip/SirenDeL‚ÄôEntreprise?token=üìù&user_id=üìù&context=üìù&recipient=üìù&object=üìù
                  ```

                  {:.fr-table}
                  | √âl√©ments composant la requ√™te              |   √âtat    | Exemples      |
                  |--------------------------------------------|-----------|---------------|
                  |**Domaine** <br>(ou pr√©fixe) <br>qui conduit √† l'API de fa√ßon s√©curis√©e| pr√©d√©fini par endpoint|`https://entreprise.api.gouv.fr`|
                  |**Num√©ro de la version** <br>(par d√©faut d√©sormais en V3)| pr√©d√©fini par endpoint| `/v3`|
                  |**Nom de la donn√©e recherch√©e** <br>(ou *endpoint*)| pr√©d√©fini par endpoint| `/attestation_fiscale_dgfip`|
                  |**Identit√© de l'√©tablissement concern√©** <br>(souvent SIREN ou SIRET)| √† choisir üìù|`/SIRENouSIRETdeL'Etablissement`|
                  |**Votre jeton d'acc√®s**| √† renseigner üìù|`?token=JetonD'Habilitation`|
                  |**Des param√®tres de tra√ßabilit√©**| √† renseigner üìù| `&context=CadreDeLaRequ√™te`<br> ‚ÑπÔ∏è Plus d'informations disponibles dans la partie [Instruire les param√®tres de tra√ßabilit√©](<%= developers_path(anchor: 'renseigner-les-param√®tres-dappel-et-de-tra√ßabilit√©') %>){:target="_blank"}|

                  #### Constatez votre premi√®re trace d‚Äôappel depuis le compte utilisateur

                  Une fois que vous avez fait un premier appel, celui-ci est **r√©pertori√©** dans votre [compte utilisateur](<%= authorization_requests_path %>){:target="_blank"}, dans la page d√©taill√©e de l'habilitation concern√©e, au niveau du jeton. Un lien vous permet d'acc√©der aux statistiques.

              - title: Configurer le logiciel m√©tier
                anchor: 'configurer-le-logiciel-m√©tier'
                content: |+
                  Documentation en construction&nbsp;üöß

              - title: Monitorer la disponibilit√© des API
                anchor: 'monitorer-la-disponibilit√©-des-api'
                content: |+
                  D√®s l'int√©gration d'API Entreprise, prenez un temps pour vous assurer d'√™tre inform√© de la disponibilit√© de nos API&nbsp;:
                  - Ajoutez des routes de pings pour automatiser la surveillance des API par vous-m√™me. Pour en savoir plus, consulter la rubrique [_"surveiller l'√©tat des fournisseurs"_](<%= developers_path(anchor: 'surveillance-etat-fournisseurs') %>) ;
                  - abonnez-vous aux incidents et op√©rations de maintenance directement depuis notre [page de statut](https://status.entreprise.api.gouv.fr/){:target="_blank"}.

          - anchor: 'incidents-et-maintenances'
            title: Incidents et maintenances&nbsp;üöß
            subsections:
              - title: Que faire en cas de rupture de service ?
                anchor: 'que-faire-en-cas-de-rupture-de-service-'
                content: |+
                  Le service ne r√©pond plus ? consultez [cette rubrique de notre FAQ](<%= faq_index_path(anchor: 'le-service-ne-repond-plus-que-faire') %>){:target="_blank"}.

              - title: √ätre inform√© des ruptures de service
                anchor: '√™tre-inform√©-des-ruptures-de-service'
                content: |+
                  1. **Abonnez-vous aux notifications** par e-mail depuis [notre page de statut](https://status.entreprise.api.gouv.fr/subscribe/email){:target="_blank"}.

                  2. **Ajoutez des routes de pings pour automatiser la surveillance** des API par vous-m√™me. Plut√¥t que de consulter ponctuellement notre page de statuts, vous pouvez vous branchez directement √† nos routes afin d'avoir un suivi encore plus pr√©cis. Pour en savoir plus, consulter la rubrique [surveiller l'√©tat des fournisseurs](<%= developers_path(anchor: 'surveillance-etat-fournisseurs') %>).

          - anchor: 'prolongation-du-jwt'
            title: Prolongation de la dur√©e de vie du JWT&nbsp;üîë
            content: >-
              Pour comprendre comment prolonger votre jeton, consultez [cette rubrique de notre FAQ](<%= faq_index_path(anchor: 'comment-prolonger-mon-jeton-arrivant-a-expiration') %>){:target="_blank"}.

