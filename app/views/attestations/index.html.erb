<h1>Interface d'appel</h1>

<h5>RÃ©cupÃ©rez l'<strong>attestation sociale</strong> d'une entreprise ou d'une association, en entrant son numÃ©ro de siret.</h5>

<div class="fr-card--horizontal fr-card--no-arrow token-card">
  <div class="fr-card__body">
    <% if current_user.any_token_with_attestation_role? %>
      <div id='attestations'>
        <div class="form-container">
          <%= form_with url: profile_attestations_search_path, data: { turbo_frame: "attestations_token" } do |f| %>
            <div class="fr-text" data-controller="token">
              <div class="fr-select-group">
                <label>ğŸ”‘ Jeton d'habilitation :</label>
                <%= select_tag(
                  :jwt_id,
                  options_for_select(
                    @jwts.map { |jwt| [
                      "Demande nÂ°#{jwt.authorization_request.external_id} - #{jwt.authorization_request.intitule}",
                      jwt.id] },
                    @best_jwt&.id
                  ),
                  { class: "fr-select", id: "token" }
                ) %>
              </div>
            </div>
            <hr>
            <div class="search-group">
              <div>
                <%= f.label :siret, "NumÃ©ro de SIRET :", { class: "fr-label" } %>
                <%= f.text_field :siret, { maxlength: 14, class: "fr-input", id: "search_siret" } %>
              </div>
              <%= f.submit "Rechercher", { class: 'fr-btn fr-btn--secondary', id: 'search' } %>
            </div>
          <% end %>
        </div>
      </div>
      <div id='attestations-result'></div>
    <% end %>
  </div>
</div>
